<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="./">
    <title>第4章：BEV与Transformer变革 (2021-2022)</title>
    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="assets/highlight.css">
    <script src="assets/script.js" defer></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: false,
                packages: {'[+]': ['noerrors', 'ams']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            },
            loader: {
                load: ['[tex]/noerrors', '[tex]/ams']
            }
        };
    </script>
</head>
<body>
    <div class="container">
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>目录</h3>
                <button id="sidebar-toggle" class="sidebar-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
            <div class="sidebar-search">
                <input type="text" id="sidebar-search-input" placeholder="搜索..." autocomplete="off">
            </div>
            <div id="tree-container">
                <nav class="tree-nav" role="tree">
                    <div class="tree-item " >
                        <a href="index.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">自动驾驶算法演进史 (2016-2024)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter1.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第1章：前深度学习时代与早期探索 (Pre-2016)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter2.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第2章：深度学习革命开端 (2016-2018)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter3.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第3章：感知架构大爆发 (2019-2020)</span>
                        </a>
                    </div>
                
                    <div class="tree-item active" >
                        <a href="chapter4.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第4章：BEV与Transformer变革 (2021-2022)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter5.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第5章：端到端浪潮 (2023-2024)</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter6.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第6章：传统感知到深度学习感知</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter7.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第7章：BEV感知革命与占据网络</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter8.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第8章：规划算法 - 从规则到学习</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter9.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第9章：控制算法与执行器协同</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter10.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第10章：端到端架构设计与演进</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter11.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第11章：端到端工程实践与挑战</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter12.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第12章：仿真技术 - 从规则驱动到神经仿真</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter13.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第13章：高精地图 vs 无图方案</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter14.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第14章：纯视觉感知 - Tesla引领的第一性原理</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter15.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第15章：激光雷达方案 - 精度与成本的平衡</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter16.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第16章：多传感器融合 - 冗余设计的必要性</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter17.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第17章：4D毫米波雷达 - 新一代感知利器</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter18.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第18章：L2渐进 vs L4跨越 - 自动驾驶的两条道路</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter19.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第19章：自动驾驶事故分析与安全挑战</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter20.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第20章：特斯拉FSD技术解密</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter21.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第21章：Waymo - L4自动驾驶的技术标杆</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter22.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第22章：百度Apollo - 从开放平台到商业化落地</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter23.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第23章：小鹏汽车 - 从NGP到XNGP的全栈自研之路</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter24.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第24章：华为车BU - ADS算法架构深度剖析</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter25.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第25章：地平线 - 芯片算法协同设计的典范</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter26.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第26章：大疆车载 - 极致成本控制下的算法创新</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter27.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第27章：Momenta - 量产与L4双线并进</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter28.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第28章：新势力与传统车企 - 中国自动驾驶的多元化探索</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter29.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第29章：L4公司转型之路</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter30.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第30章：ADAS专业供应商 - 本土化破局与差异化生存</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter31.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第31章：算法与芯片协同演进</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter32.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第32章：大模型与世界模型</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="chapter33.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">第33章：自动驾驶的终局思考</span>
                        </a>
                    </div>
                
                    <div class="tree-item " >
                        <a href="CLAUDE.html" class="tree-link">
                            <span class="tree-icon">📄</span>
                            <span class="tree-title">Untitled</span>
                        </a>
                    </div>
                </nav>
            </div>
        </nav>
        
        <main class="content">
            <article>
                <h1 id="4bevtransformer-2021-2022">第4章：BEV与Transformer变革 (2021-2022)</h1>
<h2 id="41">4.1 引言：感知范式的根本性转变</h2>
<p>2021-2022年是自动驾驶感知技术发生根本性变革的两年。如果说2016-2020年是深度学习在自动驾驶中站稳脚跟的阶段，那么这两年则见证了感知架构从2D到3D、从透视图到鸟瞰图（BEV）、从CNN到Transformer的全面升级。</p>
<h3 id="2021">为什么是2021年？</h3>
<p>多个技术趋势在2021年形成共振：</p>
<ol>
<li><strong>算力突破临界点</strong>：车规级芯片算力突破100 TOPS，使得复杂的BEV转换和Transformer计算成为可能</li>
<li><strong>Transformer在CV领域成熟</strong>：ViT、DETR等工作证明了Transformer在视觉任务上的有效性</li>
<li><strong>数据规模效应显现</strong>：Tesla积累的数十亿英里行驶数据开始展现威力</li>
<li><strong>高精地图的局限性暴露</strong>：维护成本高、更新慢、覆盖范围有限</li>
</ol>
<h3 id="bev">BEV：统一的表征空间</h3>
<p>BEV（Bird's Eye View）并非新概念，但将其作为自动驾驶的核心表征却是革命性的：</p>
<pre class="codehilite"><code>传统方案：多相机独立感知
┌─────┐  ┌─────┐  ┌─────┐
│前视  │  │左视  │  │右视  │
└──┬──┘  └──┬──┘  └──┬──┘
   ↓        ↓        ↓
独立2D检测  独立2D检测  独立2D检测
   ↓        ↓        ↓
   └────────┴────────┘
         后融合
           ↓
       3D世界理解

BEV方案：统一空间感知
┌─────┐  ┌─────┐  ┌─────┐
│前视  │  │环视  │  │后视  │
└──┬──┘  └──┬──┘  └──┬──┘
   └────────┼────────┘
           ↓
      特征级融合
           ↓
      BEV特征图
           ↓
    统一3D感知输出
</code></pre>

<h2 id="42-2021bev">4.2 2021年上半年：BEV感知的学术探索</h2>
<h3 id="detr3d3d">DETR3D：开创性的端到端3D检测</h3>
<p>2021年3月，DETR3D论文发表，首次将Transformer的object query机制引入3D目标检测：</p>
<p><strong>核心创新</strong>：</p>
<ul>
<li>使用可学习的3D reference points作为query</li>
<li>通过2D-3D几何投影采样多视角特征</li>
<li>无需复杂的后处理（NMS等）</li>
</ul>
<p><strong>架构示意</strong>：</p>
<pre class="codehilite"><code>Multi-view Images
      ↓
   ResNet50
      ↓
  2D Features
      ↓
┌──────────────┐
│  3D-to-2D    │
│  Projection  │
└──────────────┘
      ↓
Feature Sampling
      ↓
  Transformer
    Decoder
      ↓
  3D Bboxes
</code></pre>

<h3 id="bevdetbev">BEVDet：纯视觉BEV感知的里程碑</h3>
<p>2021年6月，BEVDet提出了LSS（Lift-Splat-Shoot）的改进版本：</p>
<p><strong>关键技术</strong>：</p>
<ol>
<li><strong>显式深度估计</strong>：为每个像素预测深度分布</li>
<li><strong>View Transformation</strong>：将2D特征"提升"到3D空间</li>
<li><strong>BEV Encoder</strong>：在BEV空间进行特征编码</li>
</ol>
<p><strong>性能突破</strong>：</p>
<ul>
<li>nuScenes数据集mAP: 29.8% → 39.2%</li>
<li>推理速度：30 FPS on V100</li>
<li>纯视觉方案接近LiDAR性能</li>
</ul>
<h2 id="43-tesla-ai-day-2021819bevtransformer">4.3 Tesla AI Day (2021.8.19)：BEV+Transformer的工业化宣言</h2>
<h3 id="hydranet">HydraNet：多头网络的极致设计</h3>
<p>Tesla展示的HydraNet震撼了整个行业：</p>
<pre class="codehilite"><code>                HydraNet架构
    ┌─────────────────────────────────┐
    │        8个相机 @ 36Hz            │
    └────────────┬────────────────────┘
                 ↓
    ┌─────────────────────────────────┐
    │     RegNet Backbone              │
    │   (高效的CNN特征提取器)           │
    └────────────┬────────────────────┘
                 ↓
    ┌─────────────────────────────────┐
    │     BiFPN多尺度融合               │
    └────────────┬────────────────────┘
                 ↓
         ┌───────┴───────┐
         ↓               ↓
    ┌─────────┐    ┌─────────┐
    │Transformer│    │CNN Heads│
    │  Heads   │    │         │
    └─────────┘    └─────────┘
         ↓               ↓
    Detection      Segmentation
    Tracking       Depth
    Lane           Attributes
</code></pre>

<p><strong>48个不同的输出头</strong>：</p>
<ul>
<li>目标检测（车、人、交通设施等）</li>
<li>语义分割（可行驶区域、车道线）</li>
<li>深度估计</li>
<li>运动预测</li>
<li>交通灯状态</li>
<li>道路结构理解</li>
</ul>
<h3 id="vector-space">Vector Space：从像素到向量</h3>
<p>Tesla的Vector Space代表了认知层次的提升：</p>
<p><strong>传统表征 vs Vector Space</strong>：</p>
<pre class="codehilite"><code>像素级表征：              向量化表征：
████████████             Lane: {
██░░░░██░░░██              type: &quot;divider&quot;,
██░░░░██░░░██              points: [(x1,y1), ...],
████████████               confidence: 0.95
                         }
需要后处理提取语义        直接输出结构化信息
</code></pre>

<h3 id="spatial-rnn">Spatial RNN：时序记忆的引入</h3>
<p><strong>Video Module架构</strong>：</p>
<ul>
<li>将BEV特征在时间维度上排队</li>
<li>使用Spatial RNN维护场景记忆</li>
<li>Feature queue长度：27帧（~1秒历史）</li>
</ul>
<pre class="codehilite"><code>时间步: t-26  t-25  ...  t-1   t
        ↓     ↓         ↓    ↓
      [BEV] [BEV] ... [BEV] [BEV]
        ↓     ↓         ↓    ↓
      ┌─────────────────────────┐
      │    Spatial RNN           │
      │  (ConvGRU/ConvLSTM)      │
      └─────────────────────────┘
                ↓
        时序融合的BEV特征
</code></pre>

<h2 id="44">4.4 中国市场的激进探索与安全警示</h2>
<h3 id="2021812es8-nop">2021年8月12日：蔚来ES8 NOP事故</h3>
<p><strong>事故概要</strong>：</p>
<ul>
<li>地点：福建莆田高速</li>
<li>情况：车主启用NOP（Navigate on Pilot）功能</li>
<li>结果：撞击高速公路施工区域，车主不幸身亡</li>
</ul>
<p><strong>技术分析</strong>：</p>
<ol>
<li><strong>静态障碍物检测失效</strong>：施工锥桶识别不足</li>
<li><strong>地图信息滞后</strong>：高精地图未更新施工信息</li>
<li><strong>预警系统设计缺陷</strong>：未能有效提醒驾驶员接管</li>
</ol>
<p><strong>行业影响</strong>：</p>
<ul>
<li>工信部要求车企规范宣传，不得夸大功能</li>
<li>"自动驾驶"改为"辅助驾驶"成为行业共识</li>
<li>OTA功能审查趋严</li>
</ul>
<h3 id="_1">各家应对策略</h3>
<p><strong>小鹏汽车</strong>：</p>
<ul>
<li>推出"安全驾驶提醒"功能</li>
<li>驾驶员监控系统（DMS）强制开启</li>
<li>NGP使用需要考试认证</li>
</ul>
<p><strong>理想汽车</strong>：</p>
<ul>
<li>NOA功能默认关闭</li>
<li>多重确认机制</li>
<li>强调"人类驾驶员负最终责任"</li>
</ul>
<p><strong>特斯拉</strong>：</p>
<ul>
<li>FSD Beta仍未进入中国</li>
<li>Autopilot功能相对保守</li>
<li>加强本土化数据收集</li>
</ul>
<h2 id="45-bev">4.5 BEV感知的技术爆发期</h2>
<p>2021年下半年到2022年上半年，学术界和工业界围绕BEV感知展开了激烈的技术竞赛。</p>
<h3 id="bevformer-20223query-based">BEVFormer (2022.3)：Query-based的优雅方案</h3>
<p>BEVFormer提出了一种基于Transformer的端到端BEV感知框架：</p>
<p><strong>核心创新</strong>：</p>
<ol>
<li><strong>BEV Queries</strong>：预定义的BEV网格查询</li>
<li><strong>Spatial Cross-Attention</strong>：空间注意力机制</li>
<li><strong>Temporal Self-Attention</strong>：时序自注意力</li>
</ol>
<pre class="codehilite"><code>BEVFormer架构
┌────────────────────────────────┐
│   Multi-camera Images @ t       │
└────────────┬───────────────────┘
             ↓
     ┌──────────────┐
     │   Backbone   │
     │  (ResNet101) │
     └──────┬───────┘
             ↓
    ┌────────────────┐
    │  BEV Queries   │←─── Learnable Parameters
    │  (H×W×C)       │
    └────────┬───────┘
             ↓
    ┌─────────────────────────┐
    │  Spatial Cross-Attention │
    │  (Deformable Attention)  │
    └────────┬─────────────────┘
             ↓
    ┌─────────────────────────┐
    │ Temporal Self-Attention  │←── History BEV @ t-1
    └────────┬─────────────────┘
             ↓
         BEV Features
             ↓
    ┌────────┴────────┐
    ↓                 ↓
3D Detection    Map Segmentation
</code></pre>

<p><strong>性能指标</strong>：</p>
<ul>
<li>nuScenes test: 41.6 mAP, 56.9 NDS</li>
<li>计算效率：相比DETR3D减少50%计算量</li>
<li>时序融合带来3.5 mAP提升</li>
</ul>
<h3 id="bevdepth-20226">BEVDepth (2022.6)：深度监督的重要性</h3>
<p>BEVDepth的核心洞察：准确的深度估计是BEV转换的关键。</p>
<p><strong>技术要点</strong>：</p>
<ol>
<li><strong>显式深度监督</strong>：使用LiDAR点云生成深度真值</li>
<li><strong>Camera-aware深度预测</strong>：考虑相机内参</li>
<li><strong>高效的View Transformer</strong>：优化CUDA实现</li>
</ol>
<pre class="codehilite"><code>深度估计网络设计
Image Features ──┬──→ Depth Net ──→ Depth Distribution
                 │                         ↓
Camera Intrinsics┘                   Depth Bins
                                          ↓
                                    View Transform
                                          ↓
                                     BEV Features
</code></pre>

<p><strong>关键改进</strong>：</p>
<ul>
<li>深度估计精度：相对误差从15%降至9%</li>
<li>3D检测性能：47.5 mAP (+8.3 vs baseline)</li>
<li>推理速度：41.4 FPS on 3090</li>
</ul>
<h3 id="persformer-202110">PersFormer (2021.10)：透视变换的新思路</h3>
<p>PersFormer提出了基于透视变换的3D位置编码：</p>
<p><strong>创新点</strong>：</p>
<ol>
<li><strong>3D坐标生成</strong>：直接在3D空间采样</li>
<li><strong>透视感知采样</strong>：考虑透视畸变</li>
<li><strong>无需深度估计</strong>：端到端学习投影</li>
</ol>
<h3 id="_2">各方案对比分析</h3>
<p>| 方法 | 深度估计 | 时序融合 | mAP | NDS | FPS |</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>深度估计</th>
<th>时序融合</th>
<th>mAP</th>
<th>NDS</th>
<th>FPS</th>
</tr>
</thead>
<tbody>
<tr>
<td>BEVDet</td>
<td>隐式</td>
<td>×</td>
<td>39.2</td>
<td>47.9</td>
<td>30</td>
</tr>
<tr>
<td>BEVFormer</td>
<td>隐式</td>
<td>✓</td>
<td>41.6</td>
<td>56.9</td>
<td>10</td>
</tr>
<tr>
<td>BEVDepth</td>
<td>显式监督</td>
<td>×</td>
<td>47.5</td>
<td>53.5</td>
<td>41</td>
</tr>
<tr>
<td>PersFormer</td>
<td>无需</td>
<td>×</td>
<td>40.7</td>
<td>50.9</td>
<td>25</td>
</tr>
</tbody>
</table>
<h2 id="46-2022fsd-beta">4.6 2022年：FSD Beta的大规模验证</h2>
<h3 id="_3">版本迭代轨迹</h3>
<p>2022年是FSD Beta快速迭代的一年：</p>
<p><strong>V10.x系列（2022.1-6）</strong>：</p>
<ul>
<li>10.0：首次大规模推送（1000→10000用户）</li>
<li>10.2：改进左转判断</li>
<li>10.8：城市街道导航能力</li>
<li>10.12：蠕行行为优化</li>
</ul>
<p><strong>V11.x系列（2022.11）</strong>：</p>
<ul>
<li>统一高速和城市栈</li>
<li>单一神经网络处理所有场景</li>
<li>取消高速/城市模式切换</li>
</ul>
<h3 id="_4">真实世界反馈</h3>
<p><strong>正面反馈</strong>：</p>
<ul>
<li>复杂路口处理能力显著提升</li>
<li>无保护左转成功率达到85%</li>
<li>施工区域识别准确性提高</li>
</ul>
<p><strong>持续挑战</strong>：</p>
<ul>
<li>行人意图预测仍有不足</li>
<li>雨雪天气性能下降明显</li>
<li>地图缺失区域表现不稳定</li>
</ul>
<h3 id="_5">数据飞轮效应</h3>
<pre class="codehilite"><code>FSD Beta数据循环
┌─────────────┐
│  用户使用    │
│  (10万+车辆) │
└──────┬──────┘
       ↓
┌─────────────┐
│  触发条件    │
│  Shadow Mode │
└──────┬──────┘
       ↓
┌─────────────┐
│  数据上传    │
│  (Corner Cases)│
└──────┬──────┘
       ↓
┌─────────────┐
│  自动标注    │
│  +人工审核   │
└──────┬──────┘
       ↓
┌─────────────┐
│  模型训练    │
│  Dojo超算    │
└──────┬──────┘
       ↓
┌─────────────┐
│  OTA更新     │
│  (2-4周周期) │
└──────┴──────┘
</code></pre>

<h2 id="47-occupancy-network">4.7 Occupancy Network：从检测到理解</h2>
<h3 id="occupancy">为什么需要Occupancy？</h3>
<p>传统3D检测的局限：</p>
<ol>
<li><strong>语义类别有限</strong>：只能检测预定义类别</li>
<li><strong>形状假设过强</strong>：用3D框表示所有物体</li>
<li><strong>遮挡处理困难</strong>：部分可见物体难以准确检测</li>
</ol>
<p>Occupancy Network的优势：</p>
<pre class="codehilite"><code>传统3D检测：              Occupancy表征：
┌──┐ ┌──┐ ┌──┐          ████████████████
│车│ │人│ │？│          ██░░██░░████░░██
└──┘ └──┘ └──┘          ██░░░░░░░░░░░░██
                         ████████████████
离散框表示                连续体素表示
类别受限                  通用障碍物理解
</code></pre>

<h3 id="tesla2022-ai-day">Tesla的实现（2022 AI Day）</h3>
<p><strong>网络结构</strong>：</p>
<ol>
<li><strong>体素化表征</strong>：200m×200m×20m空间</li>
<li><strong>分辨率</strong>：0.5m×0.5m×0.5m体素</li>
<li><strong>输出通道</strong>：占用概率+语义类别</li>
</ol>
<p><strong>技术细节</strong>：</p>
<pre class="codehilite"><code>BEV Features
     ↓
3D Deconvolution
     ↓
┌─────────────┐
│  Z-Lifting   │ (将BEV提升到3D)
└──────┬──────┘
       ↓
┌─────────────┐
│ 3D ConvNet   │
│  (稀疏卷积)  │
└──────┬──────┘
       ↓
Occupancy Volume

  - Free Space
  - Occupied
  - Unknown
</code></pre>

<h3 id="openoccupancy">国内跟进：OpenOccupancy基准</h3>
<p>2022年底，国内团队发布OpenOccupancy：</p>
<p><strong>数据集规模</strong>：</p>
<ul>
<li>基于nuScenes扩展</li>
<li>200万个3D体素标注</li>
<li>16个语义类别</li>
</ul>
<p><strong>基准方法</strong>：</p>
<ul>
<li>TPVFormer：三视图表征</li>
<li>SurroundOcc：环视占用预测</li>
<li>OccFormer：Transformer-based方案</li>
</ul>
<h2 id="48">4.8 向量化地图与在线建图</h2>
<h3 id="_6">高精地图的困境</h3>
<p>到2022年，高精地图方案的问题日益凸显：</p>
<p><strong>成本问题</strong>：</p>
<ul>
<li>制作成本：$1000-2000/公里</li>
<li>维护成本：每年10-20%的制作成本</li>
<li>中国高速公路：14万公里</li>
<li>城市道路：&gt;400万公里</li>
</ul>
<p><strong>更新延迟</strong>：</p>
<ul>
<li>道路施工：数周到数月延迟</li>
<li>临时变更：无法及时反映</li>
<li>新建道路：半年以上延迟</li>
</ul>
<h3 id="neural-map-prior">Neural Map Prior：神经网络地图先验</h3>
<p>2022年，多个团队提出用神经网络实时构建地图：</p>
<pre class="codehilite"><code>传统方案：                在线建图方案：
┌──────────┐            ┌──────────┐
│ HD Map   │            │ Sensors  │
│ Database │            └────┬─────┘
└────┬─────┘                 ↓
     ↓                  ┌──────────┐
┌──────────┐            │Neural Net│
│Map Match │            └────┬─────┘
└────┬─────┘                 ↓
     ↓                  ┌──────────┐
Map Elements            │Vector Map│
                        │(实时生成) │
                        └──────────┘
</code></pre>

<h3 id="hdmapnet-20217">HDMapNet (2021.7)：开创性工作</h3>
<p><strong>核心思想</strong>：</p>
<ul>
<li>将地图构建作为语义分割任务</li>
<li>直接从图像预测向量化地图元素</li>
<li>无需高精地图先验</li>
</ul>
<p><strong>网络设计</strong>：</p>
<pre class="codehilite"><code>Multi-view Images
        ↓
   CNN Backbone
        ↓
   View Transform
        ↓
    BEV Features
        ↓
   ┌────┴────┐
   ↓         ↓
Semantic  Instance
  Seg       Seg
   ↓         ↓
   └────┬────┘
        ↓
  Vectorization
        ↓
  Lane Topology
</code></pre>

<h3 id="vectormapnet-20226">VectorMapNet (2022.6)：端到端向量化</h3>
<p><strong>改进点</strong>：</p>
<ol>
<li><strong>直接输出向量</strong>：跳过栅格化步骤</li>
<li><strong>自回归解码</strong>：逐点生成折线</li>
<li><strong>拓扑关系建模</strong>：车道连接关系</li>
</ol>
<p><strong>性能对比</strong>：
| 方法 | mAP | 推理时间 | 需要HD Map |</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>mAP</th>
<th>推理时间</th>
<th>需要HD Map</th>
</tr>
</thead>
<tbody>
<tr>
<td>传统匹配</td>
<td>85.2</td>
<td>5ms</td>
<td>✓</td>
</tr>
<tr>
<td>HDMapNet</td>
<td>49.3</td>
<td>35ms</td>
<td>×</td>
</tr>
<tr>
<td>VectorMapNet</td>
<td>61.8</td>
<td>25ms</td>
<td>×</td>
</tr>
</tbody>
</table>
<h3 id="maptr-20228transformer">MapTR (2022.8)：Transformer建图</h3>
<p>MapTR将地图元素建模为一组可学习的queries：</p>
<p><strong>架构特点</strong>：</p>
<ul>
<li>统一的置换等变建模</li>
<li>层级query设计</li>
<li>端到端可微分</li>
</ul>
<pre class="codehilite"><code>MapTR Query设计
┌─────────────────┐
│ Point Queries   │ (关键点)
└────────┬────────┘
         ↓
┌─────────────────┐
│ Line Queries    │ (车道线)
└────────┬────────┘
         ↓
┌─────────────────┐
│ Polygon Queries │ (区域)
└─────────────────┘
</code></pre>

<h2 id="49-2022">4.9 2022年末：行业格局重塑</h2>
<h3 id="p72022810">小鹏P7高速事故（2022.8.10）</h3>
<p><strong>事故经过</strong>：</p>
<ul>
<li>地点：宁波某高速</li>
<li>场景：前方故障车辆停在车道内</li>
<li>结果：NGP未能识别静止车辆，追尾事故</li>
</ul>
<p><strong>技术反思</strong>：</p>
<ol>
<li><strong>AEB失效场景</strong>：高速静止目标</li>
<li><strong>视觉感知盲区</strong>：强光/阴影干扰</li>
<li><strong>毫米波雷达限制</strong>：过滤静止物体</li>
</ol>
<h3 id="_7">行业技术路线收敛</h3>
<p>到2022年底，主要玩家的技术选择趋于一致：</p>
<p><strong>共识形成</strong>：</p>
<pre class="codehilite"><code>2021年初分歧：           2022年底共识：
┌──────────┐           ┌──────────┐
│多路径探索 │           │ BEV统一   │
├──────────┤    →      ├──────────┤
│·2D/3D混合│           │·BEV为核心 │
│·规则主导 │           │·学习为主 │
│·模块分离 │           │·端到端趋势│
└──────────┘           └──────────┘
</code></pre>

<h3 id="bev_1">中国玩家的BEV实践</h3>
<p><strong>小鹏汽车XNGP</strong>：</p>
<ul>
<li>XNet：自研BEV感知网络</li>
<li>动态物体：30类识别</li>
<li>静态环境：20cm精度建图</li>
</ul>
<p><strong>理想汽车AD Max</strong>：</p>
<ul>
<li>双Orin X芯片</li>
<li>BEV+Occupancy</li>
<li>算法算力协同设计</li>
</ul>
<p><strong>华为ADS 2.0</strong>：</p>
<ul>
<li>GOD网络（通用障碍物检测）</li>
<li>RCR网络（道路拓扑推理）</li>
<li>无高精地图依赖</li>
</ul>
<p><strong>毫末智行</strong>：</p>
<ul>
<li>Transformer大模型路线</li>
<li>时空联合建模</li>
<li>CLIP视觉-语言预训练</li>
</ul>
<h3 id="bev_2">BEV成为事实标准</h3>
<p><strong>行业影响</strong>：</p>
<ol>
<li><strong>人才流动</strong>：BEV/3D视觉人才需求暴增</li>
<li><strong>开源生态</strong>：OpenMMLab等开源BEV工具链</li>
<li><strong>硬件适配</strong>：芯片厂商优化BEV算子</li>
<li><strong>数据标注</strong>：3D标注成为新瓶颈</li>
</ol>
<h2 id="410">4.10 本章总结：范式转换的深远影响</h2>
<h3 id="_8">技术层面的革命</h3>
<p>2021-2022年见证了自动驾驶感知的根本性变革：</p>
<p><strong>从2D到3D的跨越</strong>：</p>
<ul>
<li>2D检测的天花板被打破</li>
<li>3D空间理解成为标配</li>
<li>深度估计成为核心能力</li>
</ul>
<p><strong>从透视到BEV的统一</strong>：</p>
<ul>
<li>多相机融合问题得到解决</li>
<li>时序信息自然整合</li>
<li>规划控制接口简化</li>
</ul>
<p><strong>从CNN到Transformer的进化</strong>：</p>
<ul>
<li>长程依赖建模能力</li>
<li>统一的架构范式</li>
<li>更好的扩展性</li>
</ul>
<h3 id="_9">产业格局的重塑</h3>
<p><strong>技术门槛提升</strong>：</p>
<pre class="codehilite"><code>2020年前：              2022年后：
入门门槛                专业门槛
├─2D检测即可            ├─BEV感知必备
├─开源模型够用          ├─自研架构要求
├─小团队可行            ├─大团队协作
└─10人团队              └─100+人团队
</code></pre>

<p><strong>竞争焦点转变</strong>：</p>
<ul>
<li>从"能不能做"到"做得多好"</li>
<li>从"功能完整"到"体验优化"</li>
<li>从"演示Demo"到"量产交付"</li>
</ul>
<h3 id="_10">中国市场的独特路径</h3>
<p><strong>快速跟进与创新</strong>：</p>
<ol>
<li><strong>学术突破</strong>：BEVFormer等工作获得国际认可</li>
<li><strong>工程落地</strong>：小鹏/理想/华为快速产品化</li>
<li><strong>成本优化</strong>：大疆等公司的极致成本控制</li>
</ol>
<p><strong>事故推动的理性回归</strong>：</p>
<ul>
<li>蔚来、小鹏事故引发监管关注</li>
<li>"自动驾驶"宣传降温</li>
<li>用户教育和预期管理加强</li>
</ul>
<h3 id="_11">关键经验教训</h3>
<p><strong>技术层面</strong>：</p>
<ol>
<li><strong>统一表征的重要性</strong>：BEV提供了感知到规划的统一接口</li>
<li><strong>数据驱动的威力</strong>：大规模数据+神经网络超越传统方法</li>
<li><strong>架构创新的价值</strong>：Transformer带来质的飞跃</li>
</ol>
<p><strong>工程层面</strong>：</p>
<ol>
<li><strong>渐进式部署</strong>：FSD Beta的迭代验证模式</li>
<li><strong>安全冗余设计</strong>：多传感器融合仍有价值</li>
<li><strong>用户预期管理</strong>：技术能力与宣传的平衡</li>
</ol>
<h3 id="_12">对未来的启示</h3>
<p>2021-2022年的BEV革命奠定了后续发展基础：</p>
<p><strong>端到端的必然性</strong>：</p>
<ul>
<li>BEV统一表征为端到端铺平道路</li>
<li>模块边界逐渐模糊</li>
<li>数据驱动成为主流</li>
</ul>
<p><strong>规模化的挑战</strong>：</p>
<pre class="codehilite"><code>技术验证 → 工程化 → 规模化
  完成      进行中    待突破
</code></pre>

<p><strong>新的技术前沿</strong>：</p>
<ul>
<li>世界模型：从感知到理解</li>
<li>生成式方法：从判别到生成</li>
<li>大模型驱动：从专用到通用</li>
</ul>
<h3 id="_13">历史定位</h3>
<p>2021-2022年是自动驾驶发展史上的关键节点：</p>
<ol>
<li><strong>技术范式确立</strong>：BEV+Transformer成为主流</li>
<li><strong>产业格局初定</strong>：头部玩家拉开差距</li>
<li><strong>商业模式探索</strong>：L2+渐进路线获得认可</li>
</ol>
<p>这两年不仅见证了技术的飞跃，更重要的是确立了自动驾驶的"第一性原理"：<strong>通过神经网络直接从传感器数据学习驾驶</strong>。这一理念的确立，为2023年的端到端革命埋下了伏笔。</p>
<p>正如Tesla AI负责人Andrej Karpathy所说："Software 2.0时代，我们不再编写程序，而是收集数据、定义损失函数，让神经网络自己学习程序。"BEV革命正是这一理念在自动驾驶领域的完美体现。</p>
<hr />
<p><em>第4章完</em></p>
            </article>
            
            <nav class="page-nav"><a href="chapter3.html" class="nav-link prev">← 第3章：感知架构大爆发 (2019-2020)</a><a href="chapter5.html" class="nav-link next">第5章：端到端浪潮 (2023-2024) →</a></nav>
        </main>
    </div>
</body>
</html>